<div style="display:none;" class="author">
{
    "subtitle": "posit 浮点数",
    "title" : "posit 浮点数",
    "date" : "2025 - 04/05",
    "description": "posit的简单介绍",
    "tag" : ["浮点数","posit"]
}
</div>

## posit的数值计算公式
$$value = \left ( -1 \right )^{s} \times  useed^{k} \times 2^{e} \times f$$  
下面来介绍这个公式的具体含义

## posit 格式
![](http://i0.hdslb.com/bfs/new_dyn/ba8e3aa749bce57f1014f74edac9423e3546948067920012.png)

posit 由四部分组成：   
- sign bit:符号位
- regime bit:动态范围控制位
- exponent bit:指数位
- fraction bit:小数位，表示小数
- posit<n,es> :n表示二进制串的长度,es表示指数位长度.

符号位,记作s.
- 0：正数
- 1：负数

动态范围控制位
一串连续的0或1，结尾有一位与前面相反的数字表示结束.
连续的0或1的位数记作m(m>=1).
![](https://i0.hdslb.com/bfs/new_dyn/ce074bae8cddb86af4d55c4ad80749593546948067920012.png)
由图可知，为了保证表达的对称性，需要将k定义为:   
$$ \left\\{\begin{matrix}k = -m (bit = 0) \\\\k = m-1 (bit = 1)\\\\\end{matrix}\right. $$


指数位:
指数位的长度记作es,指数位的值记作e(无符号整数)
- 指数位可以为0. 比如posit<3,1> `011` 其中0为符号位，11为regime位，虽然定义了es=1,但实际操作中没有留有es和f的位置，所es=0,e=0,f=1.0
- 定义:  $useed = 2^{2^{es} } $ (注意，是2^(2^es) )
- 特别声明，在最新的[ Posit Standard (2022)   3.3 Posit format encoding ](http://posithub.org/docs/posit_standard-2.pdf)中，规定es=2.所以无特殊声明，默认es=2.

尾数位:
- 含有一个隐藏的1.比如尾数位为`1001`，则f=1.1001.
- 在实际操作中，尾数可以为0.比如posit<4,1> `0101` 其中0为符号位，10为regime位，1为指数位.没有留有f的位置，所以f=1.0



## 更直观的 posit 的数值计算公式
$$value = \left ( -1 \right )^{s} \times  2^{k\times 2^{es}+  e }  \times f$$
示例：
![](https://i0.hdslb.com/bfs/new_dyn/31bafafdba0d71054272ac8d602745703546948067920012.png)
两种特殊的情况:
(p为有符号位的二进制字串)
当p=0时，value=0;当p=-2^(n-1)时，value=$\infty $

##  软浮点的实现
软浮点库的实现有一个BFP <a href="https://gitcode.com/gh_mirrors/bf/bfp">(Beyond Floating Point)</a>的C++开源库。方法是将posit格式转换为 sign exponent fraction 的形式，然后使用浮点运算。
